import{j as e,S as u,c as f,r as R,g as x,a as M,f as D,b as k}from"../index.DXRZs43y.js";import{u as b,C as i,S,a as T,b as A,c as I,d as F,e as E,P as U}from"./chart-options-CQfSVkHI.js";import{g as q}from"./chart-helpers-DqVp7YMx.js";import{I as B}from"./Image-DjKw5cvq.js";function G({count:a=5,structure:s,bordered:l}){return e.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:a}).map((t,r)=>e.jsx(u,{className:f("w-full h-17 px-4 bg-white",{"border-b border-gray-200":l}),children:s.map(({width:d="90%",height:o="8px",radius:n="4px"},m)=>e.jsx("div",{className:"bg-slate-200 my-2",style:{width:d,height:o,borderRadius:n}},m))},r))})}function H(){const{current:a,previous:s,daysCount:l,isLoading:t,settings:r}=b(),d=(r==null?void 0:r.prChangesDisplay)!=="none",o=a==null?void 0:a.topContributors,n=s==null?void 0:s.topContributors,{data:m,options:j,totalCount:p,totalCountChange:C}=R.useMemo(()=>{const{data:y,options:w}=q(o),h=o==null?void 0:o.filter(g=>g.totalCommits>0).length,P=n==null?void 0:n.filter(g=>g.totalCommits>0).length,v=d?x(h,P):void 0;return{data:y,options:w,totalCount:h,totalCountChange:v}},[o,n]),N=d?x(a==null?void 0:a.totalCommits,s==null?void 0:s.totalCommits):void 0;return e.jsxs("div",{className:"bg-white dark:bg-gray-900 shadow-lg rounded-md px-4 pt-4 flex flex-col flex-1",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-extrabold text-gray-600 dark:text-gray-200",children:"Contributions"})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-around mb-3 w-full",children:[e.jsx(i,{isLoading:t,total:l,icon:S,iconProps:{fill:"#00c951"},label:"Days",textClassName:"text-green-700 dark:text-green-300"}),e.jsx(i,{isLoading:t,total:a.totalCommits,change:N,icon:M,iconProps:{fill:"#3a6ff0"},label:"Commits",textClassName:"text-blue-700 dark:text-blue-300"}),e.jsx(i,{isLoading:t,total:p,change:C,icon:T,iconProps:{fill:"#c10007",className:"h-7 w-7 my-auto"},label:"Contributors",textClassName:"text-green-800"})]}),e.jsxs("div",{className:"w-full flex-1",children:[t&&e.jsx("div",{className:"pb-4 h-88",children:e.jsx(A,{count:15,order:"desc"})}),!t&&!!m&&e.jsx(I,{data:m,options:j,type:"bar",width:"100%",height:370})]})]})}const O=[{width:"90%",height:"22px"},{width:"35%",height:"16px"}];function W({activities:a,isLoading:s}){return e.jsxs("div",{className:"w-full bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-300",children:e.jsx("h2",{className:"text-lg font-medium text-gray-600 dark:text-gray-200",children:"Recent Activity"})}),s&&e.jsx(G,{count:6,structure:O,bordered:!0}),!s&&!!(a!=null&&a.length)&&e.jsx(_,{activities:a}),!s&&!(a!=null&&a.length)&&e.jsx("div",{className:"p-2 text-center text-sm",children:"No activities to show"})]})}function _({activities:a}){return e.jsx("ul",{children:a.map((s,l)=>e.jsxs("li",{className:"px-4 py-3 border-b border-gray-200 last:border-0 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200 flex gap-3",children:[e.jsx(B,{src:s.user.avatar,className:"rounded-full my-auto",displayName:s.user.displayName||s.user.name}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-200 text-sm",children:s.message}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:[s.user.displayName||s.user.name," on ",D(s.timestamp)]})]})]},l))})}const $=({current:a,previous:s,isLoading:l})=>{const t=x(a.totalPRCount,s.totalPRCount),r=x(a.totalMergedPRs,s.totalMergedPRs),d=x(a.totalDeclinedPRs,s.totalDeclinedPRs),o=x(a.averageTimeToMergeInMS,s.averageTimeToMergeInMS);return e.jsx("div",{className:"flex flex-col md:flex-row p-6 bg-white dark:bg-gray-900 dark:text-gray-200 shadow-lg rounded-lg mb-6",children:e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx("h2",{className:"text-lg font-extrabold text-gray-600 dark:text-gray-200 mb-4",children:"Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 2xl:grid-cols-4 gap-4",children:[e.jsx(c,{isLoading:l,label:"Total PRs",value:a.totalPRCount,change:t}),e.jsx(c,{isLoading:l,label:"Merged PRs",value:a.totalMergedPRs,change:r}),e.jsx(c,{isLoading:l,label:"Declined PRs",value:a.totalDeclinedPRs,change:d,upArrow:d>=0,positive:!a.totalDeclinedPRs||d<0}),e.jsx(c,{isLoading:l,label:"Time to Merge (Avg.)",value:k(a.averageTimeToMergeInMS),change:o,upArrow:o>=0,positive:o<=0})]})]})})};function c({isLoading:a,label:s,value:l,change:t,positive:r=(t||0)>=0,upArrow:d=r}){if(a)return e.jsx(u,{className:"rounded-lg h-29"});const o=d?F:E;return e.jsxs("div",{className:f("border-1 border-gray-200 p-4 rounded-lg border-s-4 rounded-s-none ",{"border-s-[#6768eb]":!t,"border-s-red-500":!!t&&!r,"border-s-green-500":!!t&&r}),children:[e.jsx("h3",{className:"text-sm",children:s}),e.jsx("p",{className:"text-xl font-semibold",children:l}),!!t&&e.jsxs("span",{className:`flex text-xs mt-2 items-center ${r?"text-green-500":"text-red-500"}`,children:[e.jsx(o,{className:"w-3 h-3",stroke:r?"#2ecc81":"red"}),Math.abs(t),"%"]})]})}function V(){const{current:a,previous:s,isLoading:l,settings:t}=b();return e.jsxs("div",{children:[e.jsx(U,{title:"Dashboard"}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0 gap-4 w-full lg:max-w-1/2",children:[e.jsx($,{current:a,previous:s,isLoading:l}),(t==null?void 0:t.includeCommits)!==!1&&e.jsx(H,{})]}),e.jsx("div",{className:"flex-1",children:e.jsx(W,{activities:a.recentActivity,isLoading:l})})]})]})}export{V as default};
