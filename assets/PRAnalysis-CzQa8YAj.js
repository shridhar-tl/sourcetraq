var W=Object.defineProperty;var $=(e,s,l)=>s in e?W(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l;var P=(e,s,l)=>$(e,typeof s!="symbol"?s+"":s,l);import{r as m,j as t,c as w,L as q,d as U,h as G,s as _,e as M,i as X,u as K,k as O,l as Z,m as T,n as J,g as R,o as k}from"../index.qPuWtL5Z.js";import{t as E,u as N,f as Q,C as j,b as B,c as V,S as Y,a as L,P as ee}from"./chart-options-BM9C3PSU.js";import{P as te,p as se,e as le,a as z,S as ae,g as re,T as I,b as ne}from"./pr-analysis-DLT0ppzL.js";import{I as S,a as oe,b as ie,c as ce}from"./Image-BlJ0iVL-.js";const de=e=>m.createElement("svg",{width:"28px",height:"28px",viewBox:"0 0 24 24",fill:"#c10007",xmlns:"http://www.w3.org/2000/svg",...e},m.createElement("path",{d:"M2 5C2 4.05719 2 3.58579 2.29289 3.29289C2.58579 3 3.05719 3 4 3H20C20.9428 3 21.4142 3 21.7071 3.29289C22 3.58579 22 4.05719 22 5C22 5.94281 22 6.41421 21.7071 6.70711C21.4142 7 20.9428 7 20 7H4C3.05719 7 2.58579 7 2.29289 6.70711C2 6.41421 2 5.94281 2 5Z",fill:"inherit"}),m.createElement("path",{d:"M20.0689 8.49993C20.2101 8.49999 20.3551 8.50005 20.5 8.49805V12.9999C20.5 16.7711 20.5 18.6568 19.3284 19.8283C18.1569 20.9999 16.2712 20.9999 12.5 20.9999H11.5C7.72876 20.9999 5.84315 20.9999 4.67157 19.8283C3.5 18.6568 3.5 16.7711 3.5 12.9999V8.49805C3.64488 8.50005 3.78999 8.49999 3.93114 8.49993L11.25 8.49992L11.25 15.0454L9.55748 13.1648C9.28038 12.8569 8.80617 12.832 8.49828 13.1091C8.1904 13.3862 8.16544 13.8604 8.44254 14.1683L11.4425 17.5016C11.5848 17.6596 11.7874 17.7499 12 17.7499C12.2126 17.7499 12.4152 17.6596 12.5575 17.5016L15.5575 14.1683C15.8346 13.8604 15.8096 13.3862 15.5017 13.1091C15.1938 12.832 14.7196 12.8569 14.4425 13.1648L12.75 15.0454L12.75 8.49992L20.0689 8.49993Z",fill:"inherit"})),me=e=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{2} ",stroke:"currentColor",className:"size-4",...e},m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"})),he=e=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{2} ",stroke:"currentColor",...e},m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})),ue=e=>m.createElement("svg",{fill:"#000000",height:"26px",width:"26px",id:"XMLID_292_",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24",xmlSpace:"preserve",...e},m.createElement("g",{id:"new-window"},m.createElement("g",null,m.createElement("path",{d:"M18,24H0V6h6v2H2v14h14v-4H6V0h18v18h-6V24z M8,16h14V2H8V16z M16,13h-2v-3h-3V8h3V5h2v3h3v2h-3V13z"}))));function fe({height:e,tabs:s,className:l}){const[r,n]=m.useState(window.innerWidth),[a,c]=m.useState(s.map(i=>i.isOpen));m.useEffect(()=>{const i=()=>n(window.innerWidth);return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const d=m.useCallback(i=>{a.filter(Boolean).length===1&&a[i]||c(f=>f.map((C,b)=>b===i?!C:C))},[a]),o=a.filter(Boolean).length,u=i=>({maxWidth:i&&r>=1024?xe(o,a,s.length):void 0});return t.jsx("div",{className:w("flex flex-col lg:flex-row w-full h-full max-w-full",l),style:{minHeight:`${e}px`},children:s.map((i,h)=>{const f=a[h];return t.jsxs("div",{style:u(f),className:w("relative transition-all duration-300 bg-white",{"flex-grow border-white":f,"flex-none w-full lg:w-10 hover:bg-[#ecf2f8] px-2 lg:px-0 border border-gray-200":!f,"mt-3 ms-0 lg:mt-0 lg:ms-3":h>0&&f&&a[h-1],"mt-2 lg:mt-0":!f&&h>0&&a[h-1],"mb-2 lg:mb-0":!f&&a[h+1]}),children:[!f&&t.jsxs("div",{className:"flex lg:flex-col w-full lg:w-auto lg:h-full inset-0 cursor-pointer py-2",onClick:()=>d(h),children:[t.jsx("div",{children:t.jsx(he,{className:"size-5 mx-auto mb-1"})}),t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsx("span",{className:"text-base lg:transform lg:-rotate-90 whitespace-nowrap text-center",children:i.label})})]}),f&&t.jsxs(t.Fragment,{children:[o>1&&t.jsx("div",{className:"absolute -top-3 right-2 cursor-pointer z-10",onClick:()=>d(h),children:t.jsx("div",{className:"bg-[#f1f5f9] hover:bg-[#e2ecf7] rounded-full p-1 shadow",children:t.jsx(me,{className:"size-4"})})}),t.jsx("div",{className:"h-full overflow-hidden",children:i.render({index:h,isOpen:f,totalOpen:o})})]})]},i.id||h)})})}function xe(e,s,l){const r=12*s.reduce((c,d,o)=>d&&o&&s[o-1]?c+1:0,0),n=parseFloat((((l-e)*40+r)/e).toFixed(2));return`calc(${parseFloat((100/e).toFixed(2))}% - ${n}px)`}class pe{constructor(s){P(this,"tasks",[]);P(this,"currentCount",0);this.maxConcurrency=s}async acquire(){return this.currentCount<this.maxConcurrency?(this.currentCount++,this.release.bind(this)):new Promise(s=>{this.tasks.push(()=>{this.currentCount++,s(this.release.bind(this))})})}release(){if(this.currentCount--,this.tasks.length>0){const s=this.tasks.shift();s&&s()}}}const ge=({item:e,fetchActivity:s,maxDays:l,activityColors:r,statusColor:n,tooltipRenderer:a,semaphore:c,onItemClick:d})=>{var C,b,y;const o=m.useRef(null),[u,i]=m.useState(null),h=E(100/e.days)+"%";m.useEffect(()=>{if(u)return;const x=new IntersectionObserver(g=>{g.forEach(async v=>{if(v.isIntersecting&&!u){const p=await c.acquire();try{const D=await s(e);i(D),o.current&&x.observe(o.current)}finally{p()}}})},{rootMargin:"100px"});return o.current&&x.observe(o.current),()=>{o.current&&x.unobserve(o.current)}},[u,s,e.id,c]);const f=Array.from({length:e.days});return t.jsxs("div",{ref:o,className:"flex items-center justify-between border-b border-gray-200 h-19 py-1 ps-2 gap-2",children:[t.jsxs("div",{className:w("w-10 min-w-10",{"flex flex-col h-full justify-around":!!e.flagColor,"h-10":!e.flagColor}),children:[t.jsx(S,{src:e.user.avatar,displayName:e.user.displayName,className:"rounded-full"}),!!e.flagColor&&t.jsx("div",{className:"w-full h-3 rounded",style:{backgroundColor:e.flagColor},title:e.flagMessage})]}),t.jsxs("div",{className:"flex flex-1 flex-col gap-2 cursor-pointer max-w-[calc(100%-50px)]",onClick:d?()=>d(e):void 0,children:[t.jsxs("div",{className:"flex items-center justify-between px-1 gap-2 w-full",children:[t.jsxs("div",{className:"flex-1 text-xs overflow-hidden truncate",children:[t.jsxs(q,{href:e.url,children:["#",e.id]})," - ",e.title]}),t.jsxs("div",{className:"flex-none flex items-center gap-2",children:[t.jsx("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:U(e.startDate,e.endDate)}),t.jsxs("div",{className:"flex flex-grow gap-1",children:[(C=e.participants)==null?void 0:C.slice(0,3).map((x,g)=>t.jsx(S,{src:x.user.avatar,displayName:x.user.displayName,className:"rounded-full",size:"xs"},g)),((b=e.participants)==null?void 0:b.length)>3&&t.jsxs("div",{className:"flex flex-column items-center justify-center size-6 text-[11px] rounded-full bg-[#9cc8f3]",children:["+",((y=e.participants)==null?void 0:y.length)-3]})]}),t.jsx(te,{pr:e.pr,state:e.state})]})]}),t.jsx("div",{className:"flex bg-blue-300 border-r-5 border-r-blue-300 h-8 rounded-e-md",style:{width:`${Math.min(100,E(e.days*100/l))}%`,borderRightColor:n[e.state]},children:f.map((x,g)=>{const v=(u==null?void 0:u[g])||[];return t.jsx("div",{style:{width:h},className:"flex flex-col",onMouseEnter:a?p=>_(p,a(e,g,v)):void 0,onMouseLeave:a?()=>G():void 0,children:v!=null&&v.length?v.map((p,D)=>t.jsx("div",{className:"flex-1",style:{backgroundColor:r[p.type]||"#"+Math.floor(Math.random()*16777215).toString(16)}},D)):t.jsx("div",{className:"flex-1"})},g)})})]})]})},ve=({maxDays:e})=>t.jsxs("div",{className:"flex border-t border-gray-300 ps-2 pe-1.5 py-1 font-semibold text-xs",children:[t.jsx("span",{className:"mr-3.5",children:"Days:"}),Array.from({length:e}).map((s,l)=>t.jsx("div",{className:"flex-1",children:t.jsx("span",{className:" text-gray-600",children:l})},l)),t.jsx("div",{className:"flex-none pe-2",children:t.jsx("span",{className:"text-gray-600",children:e})})]}),we=({height:e=400,items:s,fetchActivity:l,activityColors:r={},statusColor:n={},tooltipRenderer:a,semaphoreConcurrency:c=3,onItemClick:d})=>{const o=m.useMemo(()=>Math.floor(s.reduce((i,h)=>Math.max(i,h.days),0)),[s]),u=m.useMemo(()=>new pe(c),[c]);return t.jsxs("div",{className:"w-full max-h-full",children:[t.jsx("div",{className:"flex flex-col overflow-y-auto overflow-x-hidden w-full",style:{height:e-23},children:s.map(i=>t.jsx(ge,{item:i,fetchActivity:l,maxDays:o,activityColors:r,statusColor:n,tooltipRenderer:a,semaphore:u,onItemClick:d},i.id))}),t.jsx(ve,{maxDays:o})]})};function Ce(){const{current:e,isLoading:s}=N(),l=(e==null?void 0:e.prList)||[],r=new Date,n=M(l.map(a=>{var x,g,v;const{id:c,closedDate:d,createdDate:o,reviewers:u,state:i,title:h,author:{user:f}={},description:C}=a,b=X(d||r,o),y=M(u.map(p=>({user:p.user,done:p.approved})),p=>p.done?1:0);if(!(b<1&&(i==="OPEN"||i==="MERGED")))return{id:c,user:f,participants:y,flagColor:le(C),flagMessage:se,title:h,state:i,pr:a,startDate:o,endDate:d,days:b,url:(v=(g=(x=a.links)==null?void 0:x.self)==null?void 0:g[0])==null?void 0:v.href}}).filter(Boolean),a=>a.days);return{isLoading:s,prDetails:n}}const H={APPROVED:"#28a745",RESCOPED:"#f3ae2f",COMMENTED:"#6666f1",MERGED:"purple",OTHERS:"gray",UNAPPROVED:"#f56f76"},be={MERGED:"#00c951",DECLINED:"#fb2c36"},ye=(e,s,l)=>t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"truncate",children:t.jsxs("strong",{children:["#",e.id," - ",e.title]})}),t.jsxs("strong",{children:["Day ",s+1," Activities:"]}),t.jsx("div",{children:l!=null&&l.length?l.map(r=>`${r.type}: ${r.count}`).join(", "):"(Idle)"})]});function je(e,s){const l=s.createdDate;return T(e,r=>J(r.createdDate,l)).reduce((r,n)=>(r[n.key]=T(n.values,a=>H[a.action]?a.action:"OTHERS").map(a=>({type:a.key,count:a.values.length,raw:a.values})),r),{})}function Ne(){const{isLoading:e,prDetails:s}=Ce(),[l,r]=K(Q(c=>{var d,o;return[(d=c.project)==null?void 0:d.key,(o=c.repository)==null?void 0:o.slug]})),n=c=>O(t.jsx(z,{pr:c.pr,url:c.url}),{occupy:!0}),a=async c=>{const d=c.pr;if(!d.activities){const{$repository:o}=Z("RepositoryService");d.activities=await o.getPullRequestActivity(l,r,c.id)}return je(d.activities,d)};return t.jsxs("div",{className:"bg-white shadow-lg rounded-md pt-4 flex flex-col w-full",children:[t.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4 px-4 gap-3",children:[t.jsx("h3",{className:"whitespace-nowrap text-lg font-extrabold text-gray-600",children:"Day wise Activities"}),t.jsxs("div",{className:"flex flex-nowrap gap-2 text-[11px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-5 h-3 bg-[#28a745] inline-block mr-1"})," Approved"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-5 h-3 bg-[#6666f1] inline-block mr-1"})," Comment"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-5 h-3 bg-[#f3ae2f] inline-block mr-1"})," Commit"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-5 h-3 bg-[purple] inline-block mr-1"})," Merge"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"w-5 h-3 bg-[gray] inline-block mr-1"})," Others"]})]})]}),t.jsx(we,{isLoading:e,height:457,items:s,fetchActivity:a,activityColors:H,statusColor:be,tooltipRenderer:ye,semaphoreConcurrency:3,onItemClick:n})]})}function Re(){const{current:e,previous:s,isLoading:l,settings:r}=N(),n=(r==null?void 0:r.prChangesDisplay)!=="none",a=e==null?void 0:e.topContributors,{data:c,options:d}=m.useMemo(()=>oe(a,e.contributions,s.contributions),[a]),o=n?R(e==null?void 0:e.totalPRCount,s==null?void 0:s.totalPRCount):void 0,u=n?R(e==null?void 0:e.totalMergedPRs,s==null?void 0:s.totalMergedPRs):void 0,i=n?R(e==null?void 0:e.totalDeclinedPRs,s==null?void 0:s.totalDeclinedPRs):void 0;return t.jsxs("div",{className:"bg-white shadow-lg rounded-md px-4 pt-4 flex flex-col w-full",children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsx("h3",{className:"text-lg font-extrabold text-gray-600",children:"Top Authors"})}),t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row justify-around mb-3 w-full",children:[t.jsx(j,{isLoading:l,total:e.totalPRCount,change:o,icon:ue,label:"Created",iconProps:{fill:"#00c951"},textClassName:"text-green-700"}),t.jsx(j,{isLoading:l,total:e.totalMergedPRs,change:u,icon:ae,label:"Merged",iconProps:{fill:"#1447e6",className:"h-8 w-8 my-auto"},textClassName:"text-blue-700"}),t.jsx(j,{isLoading:l,total:e.totalDeclinedPRs,change:i,icon:de,positive:i<=0,upArrow:i>0,label:"Declined",iconProps:{fill:"#c10007"},textClassName:"text-red-700"})]}),t.jsxs("div",{className:"w-full flex-1",children:[l&&t.jsx("div",{className:"pb-4 h-93",children:t.jsx(B,{count:15,order:"desc",legendsCount:3})}),!l&&!!c&&t.jsx(V,{data:c,options:d,type:"bar",width:"100%",height:370})]})]})}const F=1e3*60*60*24;function De(e){if(!(e!=null&&e.length))return[];const s=new Map;for(const r of e)for(const n of r.reviewers){const a=n.user.name;s.has(a)||s.set(a,{user:n.user,prList:[]}),s.get(a).prList.push({pr:r,reviewer:n})}const l=[];return s.forEach(({user:r,prList:n})=>{var b;const a=n.length;let c=0,d=0,o=0;const u=[],i=[];for(const{pr:y,reviewer:x}of n){x.lastReviewedCommit&&c++,(x.status==="APPROVED"||x.approved===!0)&&d++,x.status==="REJECTED"&&o++;const g=y.createdDate.getTime(),v=(b=y.closedDate)==null?void 0:b.getTime();v&&u.push(v-g);const p=y.properties.cycleTime.approveDate;p&&p>0&&i.push(p-g)}const h=a-(d+o),f=k(u)/F,C=k(i)/F;l.push({user:r,prList:n.map(y=>y.pr),totalPRCount:a,reviewedPR:c,totalApproved:d,totalRejected:o,remainingPRCount:h,averageAge:f,cycleTime:C})}),l}function Pe(){const{current:e,previous:s,daysCount:l,isLoading:r,settings:n}=N(),a=(n==null?void 0:n.prChangesDisplay)!=="none",c=e==null?void 0:e.prList,{data:d,options:o,reviewersCount:u}=m.useMemo(()=>{const h=De(c),{data:f,options:C}=ie(h);return{data:f,options:C,reviewersCount:h.length}},[c]),i=a?R(e==null?void 0:e.totalContributors,s==null?void 0:s.totalContributors):void 0;return t.jsxs("div",{className:"bg-white shadow-lg rounded-md px-4 pt-4 flex flex-col w-full",children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsx("h3",{className:"text-lg font-extrabold text-gray-600",children:"Top Reviewers"})}),t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row justify-around mb-3 w-full",children:[t.jsx(j,{isLoading:r,total:l,icon:Y,iconProps:{fill:"#00c951"},label:"Days",textClassName:"text-green-700"}),t.jsx(j,{isLoading:r,total:u,icon:L,iconProps:{fill:"#c10007",className:"h-7 w-7 my-auto"},label:"Reviewers",textClassName:"text-green-800"}),t.jsx(j,{isLoading:r,total:e.totalContributors,change:i,icon:L,iconProps:{fill:"#c10007",className:"h-7 w-7 my-auto"},label:"Contributors",textClassName:"text-green-800"})]}),t.jsxs("div",{className:"w-full flex-1",children:[r&&t.jsx("div",{className:"pb-4 h-93",children:t.jsx(B,{count:15,order:"desc",legendsCount:4})}),!r&&!!d&&t.jsx(V,{data:d,options:o,type:"bar",width:"100%",height:370})]})]})}function Ae(){const{current:e,previous:s,isLoading:l,settings:r}=N(),n=e==null?void 0:e.contributions,a=s==null?void 0:s.contributions,c=m.useMemo(()=>ce(n,a),[n,a]);return{isLoading:l,analytics:c,settings:r}}const Me=e=>{const{current:s}=N(),l=s==null?void 0:s.contributions;return m.useMemo(()=>{var n;const r=(n=l==null?void 0:l[e])==null?void 0:n.prList;return r!=null&&r.length?re(r):[]},[e,l])};function Te({username:e}){const s=Me(e),[l,r]=m.useState(null),n=({row:a})=>r(a);return t.jsx("div",{className:"w-full h-full relative overflow-hidden",children:t.jsxs("div",{className:"w-full flex transition-transform duration-300",style:{transform:`translateX(${l?-100:0}%)`},children:[t.jsx("div",{className:"w-full min-w-full",children:t.jsx(I,{containerClassName:"max-h-[80vh]",columns:ne,rows:s,noRowsMessage:"No data found",totalRows:s.length,pagination:!1,onRowClick:n})}),t.jsx("div",{className:"w-full min-w-full overflow-y-auto max-h-[88vh]",children:!!l&&t.jsx(z,{pr:l.pr,url:l.url,onBackClick:()=>r(null)})})]})})}const A=[{field:"user.displayName",title:"Author Name",template:e=>{var s,l;return((s=e.user)==null?void 0:s.displayName)||((l=e.user)==null?void 0:l.name)},headerClassName:w("text-left")},{field:"user.emailAddress",title:"Email",hideBelow:"3xl",cellClassName:w("border-e border-gray-300"),headerClassName:w("border-e border-gray-300 text-left")},{field:"totalCommits",sortable:!0,title:"Total Commits",helpText:"Total number of commits by the user during this period",cellClassName:w("border-e border-gray-300 text-center"),headerClassName:w("border-e border-gray-300 text-center"),hideBelow:"2xl",template:e=>t.jsxs(t.Fragment,{children:[e.totalCommits," ",t.jsxs("span",{className:w("text-sm",{"text-green-600":e.commitDelta.diff>0,"text-red-600":e.commitDelta.diff<0}),children:["(",e.commitDelta.diff>=0?"+":"",e.commitDelta.diff," / ",e.commitDelta.percent,"%)"]})]})},{field:"totalPRs",sortable:!0,title:"PRs",helpText:"Total number of PR's raised by the user during this period",cellClassName:"text-center",headerClassName:"text-center",template:e=>t.jsxs(t.Fragment,{children:[e.totalPRs,t.jsxs("span",{className:w("text-sm ps-1.5 hidden xl:inline-block",{"text-green-600":e.prDelta.diff>0,"text-red-600":e.prDelta.diff<0}),children:["(",e.prDelta.diff>=0?"+":"",e.prDelta.diff," / ",e.prDelta.percent,"%)"]})]})},{field:"mergedPRs",title:"Merged",sortable:!0,helpText:"Total number of PR's raised by the user during this period is merged as of now",cellClassName:"text-center",headerClassName:"text-center"},{field:"declinedPRs",sortable:!0,title:"Declined",helpText:"Total number of PR's raised by the user during this period is declined",cellClassName:"text-center",headerClassName:"text-center",template:e=>!!e.declinedPRs&&t.jsxs(t.Fragment,{children:[e.declinedPRs,t.jsxs("span",{className:w("text-sm ps-1.5 hidden xl:inline-block",{"text-green-600":e.declinedDelta.diff<0,"text-red-600":e.declinedDelta.diff>=0}),children:["(",e.declinedDelta.diff>=0?"+":"",!!e.declinedDelta.diff&&t.jsxs(t.Fragment,{children:[e.declinedDelta.diff," / ",e.declinedDelta.percent,"%)"]})]})]})},{field:"avgPROpenDays",sortable:!0,title:"Age",helpText:"Average number of days the PR was open before either it is merged or declined",cellClassName:"text-center",headerClassName:"text-center",template:e=>e.avgPROpenDays>.5?e.avgPROpenDays:""},{field:"avgDaysFirstCommitToPR",sortable:!0,title:"Lag",helpText:"Average number of days it took for the user to raise PR after the first commit was created",cellClassName:"text-center",headerClassName:"text-center",template:e=>e.avgDaysFirstCommitToPR>.5?e.avgDaysFirstCommitToPR:""},{field:"avgDaysPRToMerge",sortable:!0,title:"Merge",helpText:"Average number of days it took for the user to merge the PR",cellClassName:"text-center",headerClassName:"text-center"},{field:"avgDaysPRToApproval",sortable:!0,title:"Approval Lag",helpText:"Average number of days it took to get the Approval",cellClassName:"text-center",headerClassName:"text-center"},{field:"avgReviewers",sortable:!0,title:"Reviewers",helpText:"Average number of reviewers added to each PR",cellClassName:"text-center",headerClassName:"text-center"},{field:"avgReviewersApproved",sortable:!0,title:"Approvals",helpText:"Average number of reviewers approving the PR",cellClassName:"text-center",headerClassName:"text-center"},{field:"avgComments",sortable:!0,title:"Comments",helpText:"Average number of comments in the PR. This includes responses as well",cellClassName:"text-center",headerClassName:"text-center",template:e=>t.jsxs(t.Fragment,{children:[e.avgComments,(e.commentDelta.diff>=1||e.commentDelta.diff<=-1)&&t.jsxs("span",{className:w("text-sm ps-1.5 hidden xl:inline-block",{"text-green-600":e.commentDelta.diff<0,"text-red-600":e.commentDelta.diff>=0}),children:["(",e.commentDelta.diff>=0?"+":"",e.commentDelta.diff," / ",Math.round(e.commentDelta.percent),"%)"]})]})},{field:"avgDaysFirstActivity",sortable:!0,title:"Activity Lag",helpText:"Average number of days it took for first activity to happen in the PR.",cellClassName:"text-center",headerClassName:"text-center"}],ke={totalCommits:"includeCommits",avgDaysFirstCommitToPR:"includePRCommitMetrics",avgDaysFirstActivity:"includePRActivity",avgComments:"includePRActivity",avgDaysPRToApproval:"includePRActivity"},Ee=A.find(e=>e.field==="totalPRs");function Le(){const{isLoading:e,analytics:s,settings:l}=Ae(),r=({row:o})=>O(t.jsx(Te,{username:o.user.name}),{occupy:!0}),{includeCommits:n,includePRCommitMetrics:a,includePRActivity:c}=l||{},d=m.useMemo(()=>{if(n&&a&&c)return A;const o={includeCommits:n,includePRCommitMetrics:a,includePRActivity:c};return A.filter(u=>{const i=ke[u.field];return i?o[i]!==!1:!0})},[n,a,c]);return t.jsxs("div",{className:"my-6",children:[t.jsx("h3",{className:"text-base font-semibold mb-4",children:"Author Wise Metrics"}),t.jsx(I,{isLoading:e,expectedRows:5,columns:d,rows:s,sortColumn:Ee,sortAsc:!1,noRowsMessage:"No data found",totalRows:s.length,pagination:!1,onRowClick:r})]})}const Se=[{id:"reviewer-stats-chart",label:"Reviewer Metrics",isOpen:!0,render:()=>t.jsx(Pe,{})},{id:"pull-request-chart",label:"Pull Request Metrics",isOpen:!0,render:()=>t.jsx(Re,{})},{id:"pull-request-cycle-time-chart",label:"Cycle Time Analysis",isOpen:!1,render:()=>t.jsx(Ne,{})}];function Ie(){return t.jsxs("div",{children:[t.jsx(ee,{title:"Pull Request Analysis"}),t.jsx(fe,{tabs:Se,height:520}),t.jsx(Le,{})]})}export{Ie as default};
