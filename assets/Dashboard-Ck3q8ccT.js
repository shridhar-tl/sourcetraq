import{j as e,S as u,c as f,r as R,g as m,a as M,f as D,b as S}from"../index.B8kfND-w.js";import{u as b,C as h,S as T,a as A,b as I,c as F,d as E,e as U,P as k}from"./chart-options-DM8ui2XP.js";import{g as q}from"./chart-helpers-B-8f81-o.js";import{I as B}from"./Image-DMgGWcZf.js";function G({count:s=5,structure:a,bordered:l}){return e.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:s}).map((t,o)=>e.jsx(u,{className:f("w-full h-17 px-4 bg-white",{"border-b border-gray-200":l}),children:a.map(({width:n="90%",height:r="8px",radius:d="4px"},x)=>e.jsx("div",{className:"bg-slate-200 my-2",style:{width:n,height:r,borderRadius:d}},x))},o))})}function H(){const{current:s,previous:a,daysCount:l,isLoading:t,settings:o}=b(),n=(o==null?void 0:o.prChangesDisplay)!=="none",r=s==null?void 0:s.topContributors,d=a==null?void 0:a.topContributors,{data:x,options:j,totalCount:p,totalCountChange:C}=R.useMemo(()=>{const{data:w,options:y}=q(r),g=r==null?void 0:r.filter(i=>i.totalCommits>0).length,P=d==null?void 0:d.filter(i=>i.totalCommits>0).length,v=n?m(g,P):void 0;return{data:w,options:y,totalCount:g,totalCountChange:v}},[r,d]),N=n?m(s==null?void 0:s.totalCommits,a==null?void 0:a.totalCommits):void 0;return e.jsxs("div",{className:"bg-white shadow-lg rounded-md px-4 pt-4 flex flex-col flex-1",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-extrabold text-gray-600",children:"Contributions"})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-around mb-3 w-full",children:[e.jsx(h,{isLoading:t,total:l,icon:T,iconProps:{fill:"#00c951"},label:"Days",textClassName:"text-green-700"}),e.jsx(h,{isLoading:t,total:s.totalCommits,change:N,icon:M,iconProps:{fill:"#1447e6"},label:"Commits",textClassName:"text-blue-700"}),e.jsx(h,{isLoading:t,total:p,change:C,icon:A,iconProps:{fill:"#c10007",className:"h-7 w-7 my-auto"},label:"Contributors",textClassName:"text-green-800"})]}),e.jsxs("div",{className:"w-full flex-1",children:[t&&e.jsx("div",{className:"pb-4 h-88",children:e.jsx(I,{count:15,order:"desc"})}),!t&&!!x&&e.jsx(F,{data:x,options:j,type:"bar",width:"100%",height:370})]})]})}const O=[{width:"90%",height:"22px"},{width:"35%",height:"16px"}];function W({activities:s,isLoading:a}){return e.jsxs("div",{className:"w-full bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-300",children:e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:"Recent Activity"})}),a&&e.jsx(G,{count:6,structure:O,bordered:!0}),!a&&!!(s!=null&&s.length)&&e.jsx(_,{activities:s}),!a&&!(s!=null&&s.length)&&e.jsx("div",{className:"p-2 text-center text-sm",children:"No activities to show"})]})}function _({activities:s}){return e.jsx("ul",{children:s.map((a,l)=>e.jsxs("li",{className:"px-4 py-3 border-b border-gray-200 last:border-0 hover:bg-gray-50 transition-colors duration-200 flex gap-3",children:[e.jsx(B,{src:a.user.avatar,className:"rounded-full my-auto",displayName:a.user.displayName||a.user.name}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 text-sm",children:a.message}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a.user.displayName||a.user.name," on ",D(a.timestamp)]})]})]},l))})}const $=({current:s,previous:a,isLoading:l})=>{const t=m(s.totalPRCount,a.totalPRCount),o=m(s.totalMergedPRs,a.totalMergedPRs),n=m(s.totalDeclinedPRs,a.totalDeclinedPRs),r=m(s.averageTimeToMergeInMS,a.averageTimeToMergeInMS);return e.jsx("div",{className:"flex flex-col md:flex-row p-6 bg-white shadow-lg rounded-lg mb-6",children:e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-600",children:"Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 2xl:grid-cols-4 gap-4",children:[e.jsx(c,{isLoading:l,label:"Total PRs",value:s.totalPRCount,change:t}),e.jsx(c,{isLoading:l,label:"Merged PRs",value:s.totalMergedPRs,change:o}),e.jsx(c,{isLoading:l,label:"Declined PRs",value:s.totalDeclinedPRs,change:n,upArrow:n>=0,positive:!s.totalDeclinedPRs||n<0}),e.jsx(c,{isLoading:l,label:"Time to Merge (Avg.)",value:S(s.averageTimeToMergeInMS),change:r,upArrow:r>=0,positive:r<=0})]})]})})};function c({isLoading:s,label:a,value:l,change:t,positive:o=(t||0)>=0,upArrow:n=o}){if(s)return e.jsx(u,{className:"rounded-lg h-29"});const r=n?E:U;return e.jsxs("div",{className:f("border-1 border-gray-200 p-4 rounded-lg border-s-4 rounded-s-none ",{"border-s-[#6768eb]":!t,"border-s-red-500":!!t&&!o,"border-s-green-500":!!t&&o}),children:[e.jsx("h3",{className:"text-sm",children:a}),e.jsx("p",{className:"text-xl font-semibold",children:l}),!!t&&e.jsxs("span",{className:`flex text-xs mt-2 items-center ${o?"text-green-500":"text-red-500"}`,children:[e.jsx(r,{className:"w-3 h-3",stroke:o?"#059669":"red"}),Math.abs(t),"%"]})]})}function V(){const{current:s,previous:a,isLoading:l,settings:t}=b();return e.jsxs("div",{children:[e.jsx(k,{title:"Dashboard"}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0 gap-4 w-full lg:max-w-1/2",children:[e.jsx($,{current:s,previous:a,isLoading:l}),(t==null?void 0:t.includeCommits)!==!1&&e.jsx(H,{})]}),e.jsx("div",{className:"flex-1",children:e.jsx(W,{activities:s.recentActivity,isLoading:l})})]})]})}export{V as default};
