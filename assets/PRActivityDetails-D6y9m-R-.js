import{r as u,_ as Z,$ as Q,j as e,c as f,S as z,Z as B,k as R,a0 as J,a1 as ee,a2 as P,f as _,L as $,m as te,u as se,Q as le,a3 as H,B as ae,A as re}from"../index.-ApBqRNY.js";import{t as S,U as ne,O as q,b as oe,c as G}from"./chart-options-DaXZv2E3.js";const Me=t=>u.createElement("svg",{width:"28px",height:"28px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{d:"M22 7v1h-5v5h-1V8h-5V7h5V2h1v5zm-9.5 8a3.494 3.494 0 0 0-3.45 3h-.8l.001-.003V18H6.95A2.502 2.502 0 0 0 5 16.05v-4.1a2.477 2.477 0 0 0 1.002-.463L8.338 14H7v1h3v-3H9v1.243l-2.336-2.512A2.473 2.473 0 0 0 7 9.5a2.5 2.5 0 1 0-3 2.45v4.1A2.5 2.5 0 1 0 6.95 19h1.3l.001.002V19h.8a3.493 3.493 0 1 0 3.449-4zM3 9.5A1.5 1.5 0 1 1 4.5 11 1.502 1.502 0 0 1 3 9.5zM4.5 20A1.5 1.5 0 1 1 6 18.5 1.502 1.502 0 0 1 4.5 20zm8 1a2.5 2.5 0 1 1 2.5-2.5 2.502 2.502 0 0 1-2.5 2.5zm1.5-2.5a1.5 1.5 0 1 0-1.5 1.5 1.502 1.502 0 0 0 1.5-1.5z"}),u.createElement("path",{fill:"none",d:"M0 0h24v24H0z"})),ie=t=>u.createElement("svg",{id:"Layer_1",style:{color:"#E21B1B"},xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 511.999 511.999",xmlSpace:"preserve",...t},u.createElement("path",{style:{fill:"currentColor"},d:"M103.919,51.744c0,0,41.296,33.496,109.008,18.4c64.2-14.264,124.056-30.464,224.616,5.856v215.032 c0,0-92.488-44.104-176.736-24.432s-131.88,12.12-156.888-12.888"}),u.createElement("rect",{x:90.74,y:37.524,style:{fill:"#999999"},width:16,height:474.475}),u.createElement("circle",{style:{fill:"#666666"},cx:98.741,cy:24.284,r:24.284}));function de(t,a){const[l,n]=Z(t,a.start,a.end);return{start:l,end:n}}function ce(t,a){const{start:l,end:n}=de(a==null?void 0:a.in,t);let s=+l>+n;const d=s?+l:+n,r=s?n:l;r.setHours(0,0,0,0);let o=1;const i=[];for(;+r<=d;)i.push(Q(l,r)),r.setDate(r.getDate()+o),r.setHours(0,0,0,0);return s?i.reverse():i}function me({rows:t=5,columns:a=8,className:l,headerRowClassName:n,headerCellClassName:s,dataRowClassName:d,dataCellClassName:r,...o}){const i=Array.from({length:a}),h=Array.from({length:t}),p={gridTemplateColumns:`repeat(${a}, minmax(0, 1fr))`};return e.jsxs("div",{className:f("w-full bg-white dark:bg-gray-900",l),...o,children:[e.jsx("div",{className:f("grid border-b border-gray-300 dark:border-gray-600",n),style:p,children:i.map((v,x)=>e.jsx("div",{className:f("px-3 py-2 pe-9",s),children:e.jsx(z,{className:"h-4 w-full rounded",level:3})},x))}),h.map((v,x)=>e.jsx("div",{className:f("grid border-b border-gray-200 dark:border-gray-700 last:border-0",d),style:p,children:i.map((y,N)=>e.jsx("div",{className:f("px-3 py-3.5",r),children:e.jsx(z,{className:"h-3 w-full rounded"})},N))},x))]})}function Le(t){const a=new Date;return t.map(l=>{var j,g,A;const n=B(l.createdDate),s=B(l.closedDate),d=R(s??a,n),r=S(d),{firstCommitDate:o,firstActivityDate:i,approveDate:h}=l.properties.cycleTime,p=S(R(n,B(o)));let v=0;l.state==="MERGED"&&s&&(v=S(R(s,n)));const x=S(R(B(h),n)),y=S(R(B(i),n)),N=l.reviewers.length,T=l.reviewers.filter(w=>w.approved).length,b=l.properties.commentCount,D=l.reviewers.reduce((w,k)=>(w[k.user.name]=k,w),{});return{pr:l,prId:l.id,title:l.title,exactDaysOpen:d,daysOpen:r,daysFromFirstCommitToCreation:p,daysFromCreationToMerge:v,daysFromCreationToApproval:x,reviewers:D,reviewerCount:N,reviewersApproved:T,commentCount:b,daysFromCreationToFirstActivity:y,state:l.state,created:l.createdDate,closed:l.closedDate,url:(A=(g=(j=l.links)==null?void 0:j.self)==null?void 0:g[0])==null?void 0:A.href}})}const ue=({columns:t,rows:a,noRowsMessage:l,onRowClick:n})=>e.jsx("tbody",{children:a.length===0?e.jsx("tr",{className:"border-b border-gray-200",children:e.jsx("td",{className:"px-4 py-2 text-center",colSpan:t.length,children:l||"No records found."})}):a.map((s,d)=>e.jsx("tr",{className:f("border-b border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800",n?"cursor-pointer":""),onClick:n?r=>n({row:s,index:d,event:r}):void 0,children:t.map((r,o)=>{const i=r.template?r.template(s):J(s,r.field),h=typeof i=="string"||typeof i=="number"?i:"";return e.jsx("td",{className:f("text-sm px-4 py-2 truncate text-ellipsis",{hidden:!!r.hideBelow,"xs:table-cell":r.hideBelow==="xs","sm:table-cell":r.hideBelow==="sm","md:table-cell":r.hideBelow==="md","mlg:table-cell":r.hideBelow==="mlg","lg:table-cell":r.hideBelow==="lg","xl:table-cell":r.hideBelow==="xl","2xl:table-cell":r.hideBelow==="2xl","3xl:table-cell":r.hideBelow==="3xl"},r.cellClassName),title:h.toString(),children:i},o)})},d))});function xe({label:t,iconLeft:a,iconRight:l,children:n,className:s,...d}){const r=e.jsxs(e.Fragment,{children:[!!a&&e.jsx(a,{className:"absolute left-2 top-1/2 transform -translate-y-1/2"}),n,!!l&&e.jsx(l,{className:"absolute right-2 top-1/2 transform -translate-y-1/2"})]});return e.jsxs("div",{className:f("relative w-full ",s,{"border border-gray-300 rounded min-h-[30px] pt-[1px]":!t,"rounded-[8px] min-h-[55px]":!!t}),...d,children:[!t&&r,!!t&&e.jsxs("fieldset",{className:"relative border rounded-[8px] h-full w-full bg-white",children:[e.jsx("legend",{className:"text-labelBlue font-bold text-13px ms-3 px-1",children:t}),r]})]})}function he({label:t,placeholder:a="Choose here...",options:l=[],showFilter:n=l.length>10,showClear:s=!0,onChange:d,value:r,className:o}){const[i,h]=u.useState(!1),[p,v]=u.useState(""),[x,y]=u.useState(-1),[N,T]=u.useState(null),b=u.useRef(null),D=u.useRef(null),C=u.useRef(null),j=p?l.filter(c=>c.label.toString().toLowerCase().includes(p.toLowerCase())):l,g=l.find(c=>c.value===r),A=()=>h(c=>!c),w=()=>{h(!1),v(""),y(-1)},k=c=>{d(c.value),w()},F=c=>{c.stopPropagation(),d(null)},M=()=>{if(b.current){const c=b.current.getBoundingClientRect(),m=200,E=window.innerHeight-c.bottom,U=c.top,I=E<m&&U>m,X=window.innerWidth<=640?window.innerWidth*.9:c.width,Y=window.innerWidth<=640?window.innerHeight*.8:I?U:E;T({top:I?c.top-(I?m:0)+window.scrollY:c.bottom+window.scrollY,left:window.innerWidth<=640?window.innerWidth*.05:c.left+window.scrollX,maxHeight:Y,width:X,dropUp:I})}};u.useEffect(()=>{const c=m=>{b.current&&!b.current.contains(m.target)&&D.current&&!D.current.contains(m.target)&&w()};return i?(document.addEventListener("mousedown",c),M(),y(-1)):(document.removeEventListener("mousedown",c),v("")),()=>{document.removeEventListener("mousedown",c)}},[i]),u.useEffect(()=>{const c=()=>{i&&M()};return window.addEventListener("resize",c),window.addEventListener("scroll",c,!0),()=>{window.removeEventListener("resize",c),window.removeEventListener("scroll",c,!0)}},[i]),u.useEffect(()=>{i&&C.current&&C.current.focus()},[i,n]),u.useEffect(()=>{if(x>=0&&D.current){const m=D.current.children[x];m&&m.scrollIntoView({block:"nearest"})}},[x]);const V=c=>{if(!i){(c.key==="ArrowDown"||c.key==="Enter")&&(h(!0),c.preventDefault());return}switch(c.key){case"ArrowDown":y(m=>Math.min(m+1,j.length-1)),c.preventDefault();break;case"ArrowUp":y(m=>Math.max(m-1,0)),c.preventDefault();break;case"Enter":x>=0&&x<j.length&&k(j[x]),c.preventDefault();break;case"Escape":w(),c.preventDefault();break}},L=e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:b,className:f("h-full flex items-center justify-between cursor-pointer mt-[-4px]",o),onClick:A,onKeyDown:V,tabIndex:0,"aria-haspopup":"listbox","aria-expanded":i,children:[e.jsx("span",{className:f("flex-1 px-4 text-sm",g?"text-black":"text-pBlack"),children:g?g.label:a}),s&&!!r&&e.jsx("button",{onClick:F,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Clear selection",children:"×"}),e.jsx("div",{className:"w-0 h-0 me-3 border-t-[6px] border-b-0 border-l-[3.5px] border-r-[3.5px] border-transparent border-t-labelBlue"})]}),i&&N&&ee.createPortal(e.jsxs("div",{className:f("absolute z-50 bg-white border border-gray-300 rounded shadow-lg",window.innerWidth<=640?"fixed top-0 left-0 right-0 bottom-0 m-auto":""),style:{top:window.innerWidth<=640?"10%":N.top,left:window.innerWidth<=640?"5%":N.left,width:window.innerWidth<=640?"90%":N.width,maxHeight:window.innerWidth<=640?"80%":N.maxHeight,overflow:"auto"},role:"listbox","aria-activedescendant":x>=0?`selectbox-option-${x}`:void 0,children:[n&&e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsx("input",{ref:C,type:"text",value:p,onChange:c=>v(c.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring bg-white",placeholder:"Filter...",onKeyDown:c=>c.stopPropagation(),"aria-label":"Filter options"})}),e.jsx("div",{className:"max-h-60 overflow-auto",ref:D,role:"presentation",children:j.length>0?j.map((c,m)=>e.jsx("div",{id:`selectbox-option-${m}`,onClick:()=>k(c),onMouseEnter:()=>y(m),className:f("px-4 py-2 cursor-pointer text-black text-xs",(g==null?void 0:g.value)===c.value?"bg-blue-500 text-white":"",x===m?"bg-gray-200":"","border-b border-gray-100 last:border-b-0"),role:"option","aria-selected":(g==null?void 0:g.value)===c.value,children:c.label},c.value)):e.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No options found"})})]}),document.body)]});return t?e.jsx(xe,{label:t,children:L}):L}function fe({columns:t,rowsCount:a,pageIndex:l,totalPages:n,rowsCounts:s,onChangeCount:d,onNavigate:r}){const o=s.map(i=>({label:i,value:i}));return e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"Rows per page"}),e.jsx(he,{className:"border border-gray-300 rounded px-2 py-1",value:a,options:o,showClear:!1,onChange:d})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{className:"font-bold text-2xl disabled:text-[#695A5A]",onClick:()=>r(1),disabled:l===1,children:"«"}),e.jsx("button",{className:"font-bold text-2xl disabled:text-[#695A5A]",onClick:()=>r(l-1),disabled:l===1,children:"‹"}),e.jsxs("span",{className:"px-2 text-sm font-medium",children:[l," of ",n||1]}),e.jsx("button",{className:"font-bold text-2xl disabled:text-[#695A5A]",onClick:()=>r(l+1),disabled:l>=n||!n,children:"›"}),e.jsx("button",{className:"font-bold text-2xl disabled:text-[#695A5A]",onClick:()=>r(n),disabled:l>=n||!n,children:"»"})]})]})})})})}const pe=({columns:t,sortColumn:a,sortAsc:l,onSort:n})=>e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-300",children:t.map((s,d)=>{const r=s.sortable&&(a==null?void 0:a.field)===s.field;return e.jsxs("th",{title:s.helpText,className:f("px-4 py-2 font-semibold text-sm text-gray-800 dark:text-gray-100 select-none",{"cursor-pointer":s.sortable,hidden:!!s.hideBelow,"xs:table-cell":s.hideBelow==="xs","sm:table-cell":s.hideBelow==="sm","md:table-cell":s.hideBelow==="md","mlg:table-cell":s.hideBelow==="mlg","lg:table-cell":s.hideBelow==="lg","xl:table-cell":s.hideBelow==="xl","2xl:table-cell":s.hideBelow==="2xl","3xl:table-cell":s.hideBelow==="3xl"},s.headerClassName),onClick:()=>n(s),children:[s.title,r&&e.jsx("span",{className:"ml-1",children:l?"↓":"↑"})]},d)})})});function be(t,a,l=!0,n){return u.useMemo(()=>!n||!a||!(t!=null&&t.length)?t:[...t].sort((s,d)=>{const r=s[a],o=d[a];if(P(r)&&P(o))return 0;if(P(r))return l?-1:1;if(P(o))return l?1:-1;let i=0;if(typeof r=="number"&&typeof o=="number")i=r-o;else if(r instanceof Date&&o instanceof Date)i=r.getTime()-o.getTime();else{const h=String(r).toLowerCase(),p=String(o).toLowerCase();h<p?i=-1:h>p?i=1:i=0}return l?i:-i}),[t,a,l,n])}const ge=[10,20,25,50,75,100];function ve({isLoading:t,expectedRows:a,columns:l,rows:n,totalRows:s,page:d,sortColumn:r,sortAsc:o,onSort:i,onChange:h,noRowsMessage:p,rowsPerPage:v,rowCounts:x=ge,pagination:y,containerClassName:N,onRowClick:T}){const[b,D]=u.useState(r),[C,j]=u.useState(o??!0),[g,A]=u.useState(d||1),[w,k]=u.useState(v??x[0]),F=Math.ceil(s/w),M=be(n,b==null?void 0:b.field,C,s===(n==null?void 0:n.length));if(t)return e.jsx(me,{columns:l==null?void 0:l.length,rows:a});const V=m=>{if(!m.sortable)return;let E=!0;b&&b.field===m.field&&(E=!C),D(m),j(E),i&&i(m,E),h&&h({sortColumn:m,sortAsc:E,count:w,pageNumber:g})},L=m=>{k(m),A(1),h&&h({sortColumn:b||void 0,sortAsc:C,count:m,pageNumber:1})},c=m=>{m<1||m>F||(A(m),h&&h({sortColumn:b||void 0,sortAsc:C,count:w,pageNumber:m}))};return e.jsx("div",{className:f("overflow-auto",N),children:e.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-900 dark:text-gray-200 rounded shadow border border-gray-100",children:[e.jsx(pe,{columns:l,sortColumn:b,sortAsc:C,onSort:V}),e.jsx(ue,{columns:l,rows:M,noRowsMessage:p,onRowClick:T}),y!==!1&&e.jsx(fe,{columns:l,pageIndex:g,rowsCount:w,rowsCounts:x,totalPages:F,onChangeCount:L,onNavigate:c})]})})}function K({pr:t,state:a=t==null?void 0:t.state}){return e.jsx("span",{className:f("px-2 py-1 text-xs rounded text-white",{"bg-green-500":a==="MERGED","bg-red-500":a==="DECLINED","bg-blue-500":a!=="MERGED"&&a!=="DECLINED"}),children:a||"Unknown"})}const Ie=[{field:"prId",title:"PR Id",helpText:"Unique id of current PR",headerClassName:f("text-left"),template:t=>t.url?e.jsxs($,{href:t.url,children:["#",t.prId]}):t.prId},{field:"title",title:"Title",cellClassName:f("max-w-[500px]"),headerClassName:f("max-w-[500px] text-left")},{field:"state",title:"State",sortable:!0,helpText:"The current state of the PR",cellClassName:"text-center",headerClassName:"text-center",template:t=>e.jsx(K,{pr:t})},{field:"created",title:"Created",sortable:!0,helpText:"Date when this PR was created",cellClassName:"text-center",headerClassName:"text-center",template:t=>_(t.created)},{field:"closed",title:"Closed",sortable:!0,helpText:"Date when this PR was Closed / Declined",cellClassName:"text-center",headerClassName:"text-center",template:t=>t.closed?_(t.closed):null},{field:"daysOpen",title:"Age",sortable:!0,helpText:"Number of days the PR was open before either it is merged or declined",cellClassName:"text-center",headerClassName:"text-center"},{field:"daysFromFirstCommitToCreation",title:"Lag",sortable:!0,helpText:"Number of days it took for the user to raise PR after the first commit was created",cellClassName:"text-center",headerClassName:"text-center"},{field:"daysFromCreationToApproval",title:"Approval Lag",sortable:!0,helpText:"Number of days it took to get the Approval",cellClassName:"text-center",headerClassName:"text-center"},{field:"reviewerCount",title:"Reviewers",sortable:!0,helpText:"Number of reviewers added to PR",cellClassName:"text-center",headerClassName:"text-center"},{field:"reviewersApproved",title:"Approvals",sortable:!0,helpText:"Number of reviewers approving the PR",cellClassName:"text-center",headerClassName:"text-center"},{field:"commentCount",title:"Comments",sortable:!0,helpText:"Number of comments in the PR. This includes responses to comments as well",cellClassName:"text-center",headerClassName:"text-center"},{field:"daysFromCreationToFirstActivity",title:"Activity Lag",sortable:!0,helpText:"Number of days it took for first activity to happen in the PR.",cellClassName:"text-center",headerClassName:"text-center"}];function we({legendsCount:t,legendPosition:a,doughnut:l,containerClassName:n}){const s=!!t&&e.jsx(ne,{count:t,position:a}),d=a=="top"||a==="bottom";return e.jsxs("div",{className:f("flex justify-center",{"flex-col gap-5":d,"gap-3":!d},n),children:[(a=="top"||a==="left")&&s,e.jsx("div",{className:"size-[360px] rounded-full",children:e.jsx(z,{className:"h-full rounded-full",children:!!l&&e.jsx("div",{className:"absolute inset-0 rounded-full m-auto size-[200px] bg-white"})})}),(a=="right"||a==="bottom")&&s]})}const ye=[{field:"date",title:"Date",sortable:!0,headerClassName:"text-left",cellClassName:"text-left"},{field:"comments",title:"Comments",sortable:!0,headerClassName:"text-center",cellClassName:"text-center"},{field:"approvals",title:"Approvals",sortable:!0,headerClassName:"text-center",cellClassName:"text-center"},{field:"rescoped",title:"Commits",sortable:!0,headerClassName:"text-center",cellClassName:"text-center"}];async function Ne(t){const{$repository:a}=te("RepositoryService"),{project:l,repository:n}=se.getState(),s=t.activities||await a.getPullRequestActivity(l==null?void 0:l.key,n==null?void 0:n.slug,t.id),d=Ce(s,t),r=De(d),o=Ae(s),i=ke(s,d,t);return{stackedChart:r,reviewerChart:o,metrics:i,dailyMetrics:d.dailyData}}function Ce(t,a){const l=je(t,a),n=le(Object.keys(l));let s=0;const d=n.map(o=>{const i=l[o],h=i.filter(x=>x.action==="COMMENTED").length,p=i.filter(x=>x.action==="APPROVED").length,v=i.filter(x=>x.action==="RESCOPED").length;return s+=h,{date:o,comments:h,rescoped:v,approvals:p}});let r=0;return n.length&&(r=Object.values(l).filter(o=>!o.length).length),{labels:n,dailyData:d,totalComments:s,idleDays:r}}function je(t,a){const{createdDate:l,closedDate:n}=a,s=ce({start:l,end:n||new Date}).reduce((d,r)=>(d[H(r,"yyyy-MM-dd")]=[],d),{});return t.reduce((d,r)=>{const o=H(r.createdDate,"yyyy-MM-dd");return d[o]||(d[o]=[]),d[o].push(r),d},s)}function De(t){const a=t.labels,l=t.dailyData.map(o=>o.comments),n=t.dailyData.map(o=>o.approvals),s=t.dailyData.map(o=>o.rescoped),d={labels:a,datasets:[l.some(o=>!!o)&&{type:"bar",label:"Comments",data:l,backgroundColor:"#007BFF",stack:"Activity"},n.some(o=>!!o)&&{type:"bar",label:"Approvals",data:n,backgroundColor:"#4CAF50",stack:"Activity"},s.some(o=>!!o)&&{type:"bar",label:"Commits",data:s,backgroundColor:"#FF9800",stack:"Activity"}].filter(Boolean)},r={...q(),plugins:{tooltip:{mode:"index",intersect:!1},legend:{display:!0}},scales:{x:{stacked:!0},y:{stacked:!0,title:{display:!1,text:"Count"},ticks:{beginAtZero:!0}}}};return{data:d,options:r}}function Ae(t){const a={};t.forEach(o=>{if(o.action==="COMMENTED"&&o.user){const i=o.user.displayName||o.user.name||"Unknown";a[i]=(a[i]||0)+1}});const l=Object.keys(a),n=l.map(o=>a[o]),s=l.map((o,i)=>`hsl(${i*50%360}, 70%, 60%)`),d={labels:l,datasets:[{label:"Comments Count",data:n,backgroundColor:s}]},r={...q(),maintainAspectRatio:!0,plugins:{legend:{position:"right"}}};return{data:d,options:r}}function ke(t,a,l){let n=null,s=null;t.forEach(o=>{o.action==="APPROVED"&&((!n||o.createdDate.getTime()<n.getTime())&&(n=o.createdDate),(!s||o.createdDate.getTime()>s.getTime())&&(s=o.createdDate))});let d="N/A";if(n&&s){const o=R(s,n);o>0&&(d=S(o)+" days")}let r="N/A";if(n){let o=null;l.state!=="MERGED"?o=new Date:o=l.closedDate,o&&(r=S(R(o,n))+" days")}return{idleDays:a.idleDays,daysOpenAfterApproval:r,approvalLag:d,totalComments:a.totalComments}}const Ee="PR description is unavailable or is too short";function Re(t){const a=(t==null?void 0:t.trim().length)||0;return a>=200?"":a>=175?"#FFFACD":a>=130?"#FFD700":a>=95?"#FFA500":a>=50?"#FF5722":"#E21B1B"}function Se(t){const[a,l]=u.useState(W());return u.useEffect(()=>{const n=()=>l(W());return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),u.useEffect(()=>{t&&l(W())},[t]),a}function W(){return Math.random().toString(36).substring(2,9)}function Pe({pr:t,url:a,className:l,onBackClick:n}){const[s,d]=u.useState(null),[r,o]=u.useState(!1),[i,h]=u.useState(null),p=u.useRef(null);u.useEffect(()=>{var x;t&&(h(Re(t.description)),o(!0),(x=p.current)==null||x.scrollIntoView({behavior:"smooth"}),Ne(t).then(y=>d(y)).finally(()=>o(!1)))},[t]);const v=e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-900 shadow rounded-lg flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[e.jsx("div",{children:e.jsxs("h3",{className:"text-lg font-bold flex gap-3 cursor-pointer",ref:p,children:[!!n&&e.jsx(ae,{variant:"plain",leftIcon:re,onClick:n}),e.jsxs($,{href:a,newTab:!0,children:["#",t.id]}),t.title,!!i&&e.jsx("span",{title:Ee,children:e.jsx(ie,{className:"size-6 mr-2",style:{color:i}})})]})}),e.jsxs("div",{className:"flex flex-col sm:items-end",children:[e.jsxs("p",{className:"text-sm",children:["Created: ",t.createdDate?H(t.createdDate,"PPP"):"N/A"]}),e.jsxs("p",{children:[e.jsx(K,{pr:t}),t.state==="MERGED"&&e.jsxs("span",{className:"text-xs ms-2",children:["(",H(t.closedDate,"PPP"),")"]})]})]})]});return e.jsxs("div",{className:f("dark:text-gray-200",l),children:[v,e.jsxs("div",{className:"animate-fadeIn flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex flex-col flex-1 shadow-lg rounded-lg p-4 bg-white dark:bg-gray-900 max-h-[440px] lg:max-w-1/2",children:[e.jsx("h4",{className:"text-lg font-bold mb-2",children:"Daily Activity Overview"}),e.jsxs("div",{className:"w-full h-[370px]",children:[r&&e.jsx(oe,{barWidth:80,count:14,legendsCount:4,order:"random",className:"h-[370px]"}),!r&&s&&e.jsx(G,{type:"bar",data:s.stackedChart.data,options:s.stackedChart.options,width:"100%",height:370})]})]}),e.jsx(Te,{isLoading:r,data:s==null?void 0:s.reviewerChart})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 flex-1 grid grid-cols-1 md:grid-cols-2 gap-4 shadow-lg rounded-lg p-4",children:[e.jsx(O,{isLoading:r,className:"bg-green-100 dark:bg-green-900",label:"Total Idle Days",value:s==null?void 0:s.metrics.idleDays}),e.jsx(O,{isLoading:r,className:"bg-yellow-100 dark:bg-yellow-900",label:"Days Open After Approval",value:s==null?void 0:s.metrics.daysOpenAfterApproval}),e.jsx(O,{isLoading:r,className:"bg-red-100 dark:bg-red-900",label:"Approval Lag (First vs Last)",value:s==null?void 0:s.metrics.approvalLag}),e.jsx(O,{isLoading:r,className:"bg-blue-100 dark:bg-blue-900",label:"Total Comments",value:s==null?void 0:s.metrics.totalComments})]}),e.jsxs("div",{className:"flex-1 shadow-lg rounded-lg p-4 bg-white dark:bg-gray-900 max-h-[400px] overflow-auto",children:[e.jsx("h4",{className:"text-lg font-bold mb-2",children:"Daily Metrics Details"}),e.jsx(ve,{isLoading:r,containerClassName:"w-full",columns:ye,rows:(s==null?void 0:s.dailyMetrics)||[],noRowsMessage:"No details available",totalRows:(s==null?void 0:s.dailyMetrics.length)||0,pagination:!1})]})]})]})]})}function Te({isLoading:t,data:a}){const l=Se(a);return e.jsxs("div",{className:"flex flex-col flex-1 shadow-lg rounded-lg p-4 bg-white dark:bg-gray-900 max-h-[440px] lg:max-w-1/2",children:[e.jsx("h4",{className:"text-lg font-bold mb-2",children:"Reviewer Wise Comments"}),e.jsxs("div",{className:"w-full h-[370px]",children:[t&&e.jsx(we,{legendsCount:4,legendPosition:"right",className:"h-[370px]",doughnut:!0}),!t&&a&&e.jsx(G,{className:"mx-auto w-full max-h-[370px]",type:"doughnut",data:a.data,options:a.options,height:370},l)]})]})}function O({isLoading:t,className:a,label:l,value:n}){return t?e.jsx(z,{level:1}):e.jsxs("div",{className:f("p-4 bg-green-100 rounded-lg shadow",a),children:[e.jsx("h4",{className:"font-bold",children:l}),e.jsx("p",{className:"text-2xl",children:n})]})}export{K as P,Me as S,ve as T,Pe as a,Ie as b,Re as e,Le as g,Ee as p};
